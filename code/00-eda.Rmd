
---
title: "Gray Whale EDA"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Load libraries & data

```{r}

# libraries
library(dplyr)
library(tidyverse)
library(vegan)
library(ggplot2)

# dataset. Note you'll need to change the file path to match where it is on your computer
#data <- read.csv("Users/cmantegna/Documents/GitHub/sicb_dp/data/graywhales.csv")

```

# Data cleaning
## uniform variables and backfilling the empty cells
```{r}

# fix variable names in the channel and source columns. 
# since both uppercase and lowercase are used, they will be treated as unique cases, this step stops that from happening. The 'dplyr' package does this.
data <- data %>%
  mutate(Channel = tolower(Channel),
         Source = tolower(Source))

# fill in missing values
# after reviewing the missing data, the missing times were filled in manually with 0:00. 
# missing counts were replaced with 1 because at least one whale was seen to report it.
# missing source or channel names were replaced with 'unknown'
data <- data %>%
  mutate(Count = ifelse(is.na(Count), 1, Count),
         Source = ifelse(is.na(Source), "unknown", Source))

# write out cleaned data to work with later. this is a safety stop so you don't have to keep doing it. Make sure you update your path to the correct one on your computer.
#write_csv(data, "Users/cmantegna/Documents/GitHub/sicb_dp/data/cleaned_data.csv")

```

```

## pull out the month from the sighting date
```{r}

# convert SightDate to date format and extract the month
data <- data %>%
  mutate(SightDate = as.Date(SightDate, format = "%m/%d/%y"),
         Month = format(SightDate, "%m"))
         
```

# EDA
## Counts, total

```{r}

#total number of whales sighted from 2013 - 2023
#save the table it creates if you don't want to copy paste the data OR you can knit this markdown file to a pdf or html file that supports printing/ manipulation.

total_count <- sum(data$Count, na.rm = TRUE)
print(paste("Total Whale Count:", total_count))

```


## Counts, monthly
```{r}

#total number of whales counted per month regardless of year

monthly_counts <- data %>%
  group_by(Month) %>%
  summarise(TotalCount = sum(Count, na.rm = TRUE))

print(monthly_counts)

```

## Counts, seasonally
```{r}

#create a season column
data <- data %>%
  mutate(Season = case_when(
    month(SightDate) %in% c(12, 1, 2) ~ "Winter",
    month(SightDate) %in% c(3, 4, 5) ~ "Spring",
    month(SightDate) %in% c(6, 7, 8) ~ "Summer",
    month(SightDate) %in% c(9, 10, 11) ~ "Fall"
  ))

#group by season
seasonal_counts <- data %>%
  group_by(Season) %>%
  summarise(TotalCount = sum(Count, na.rm = TRUE)) %>%
  arrange(match(Season, c("Winter", "Spring", "Summer", "Fall")))

#print
print(seasonal_counts)

#plot seasonal trends
library(ggplot2)

ggplot(seasonal_counts, aes(x = Season, y = TotalCount, fill = Season)) +
  geom_bar(stat = "identity") +
  labs(title = "Whale Sightings by Season",
       x = "Season",
       y = "Total Count of Sightings") +
  theme_minimal()

```


## Counts, quad

```{r}

#total number of whales counted per quad regardless of year
quad_counts <- data %>%
  group_by(Quad) %>%
  summarise(TotalCount = sum(Count, na.rm = TRUE))

print(quad_counts)

```

# Channel and Source Summaries

```{r}

# need to go back and review if I set this up correctly - this is treating these like independent variables, not dependent...

channel_summary <- data %>%
  count(Channel)

source_summary <- data %>%
  count(Source)

print(channel_summary)
print(source_summary)

```

# 