---
title: Plots 01: Sounders' Movements and Habits
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Load libraries

```{r}

# libraries
library(dplyr)
library(tidyverse)
library(vegan)
library(ggplot2)
library(reader)

```

# Load data
## only working with the Sounders' data in this markdown file

```{r}

# figure out where you are on your computer
getwd()

# we're going to focus on only the data for the sounders for this one. Note you'll need to change the file path to match where it is on your computer
#data <- read.csv("/Users/cmantegna/Documents/GitHub/sicb_dp/data/sounders.csv")
data <- read.csv("/Users/cmantegna/Documents/GitHub/sicb_dp/output/data_adjusted/sounders_added_rows.csv")

```

# Temporal Visualization
## line chart for sightings by year
```{r}

library(ggplot2)

# Summarize sightings by year
sightings_by_year <- data %>%
  group_by(year) %>%
  summarize(total_sightings = sum(count))

# Create a line chart
ggplot(sightings_by_year, aes(x = year, y = total_sightings)) +
  geom_line() +
  geom_point() +
  ggtitle("Sightings Count Over Years") +
  xlab("Year") +
  ylab("Total Sightings") +
  theme_minimal()

```

## heatmap of sightings by month and year
```{r}

# Summarize sightings by month and year
sightings_heatmap <- data %>%
  group_by(year, month) %>%
  summarize(total_sightings = sum(count))

# Create a heatmap
ggplot(sightings_heatmap, aes(x = factor(month), y = factor(year), fill = total_sightings)) +
  geom_tile() +
  scale_fill_gradient(low = "lightblue", high = "darkblue", name = "Sightings") +
  ggtitle("Heatmap of Sightings by Month and Year") +
  xlab("Month") +
  ylab("Year") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```

## polar chart sightings by season
```{r}

# Summarize sightings by season
sightings_by_season <- final_data %>%
  group_by(season) %>%
  summarize(total_sightings = sum(count))

# Create a polar chart
ggplot(sightings_by_season, aes(x = season, y = total_sightings, fill = season)) +
  geom_bar(stat = "identity") +
  coord_polar(theta = "x") +
  ggtitle("Sightings by Season") +
  xlab("") +
  ylab("Total Sightings") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```

## count by season and year
## I'm a sucker for a wrapped plot...
```{r}

library(ggplot2)
library(dplyr)

# Group by year and season to get seasonal counts for each year
seasonal_counts_by_year <- data %>%
  group_by(year, season) %>%
  summarise(totalCount = sum(count, na.rm = TRUE)) %>%
  arrange(year, match(season, c("Winter", "Spring", "Summer", "Fall")))

# Print the grouped data
print(seasonal_counts_by_year)

# Plot seasonal trends by year
ggplot(seasonal_counts_by_year, aes(x = season, y = totalCount, fill = season)) +
  geom_bar(stat = "identity") +
  facet_wrap(~ year) +  # Create a grid of plots, one for each year
  labs(title = "Whale Sightings by Season and Year",
       x = "Season",
       y = "Total Count of Sightings") +
  theme_minimal()

```



## 'map' of sightings

```{r}

# plotting with lat/ long coordinates, but not overlayed on a map - just want to see what it looks like

library(ggplot2)

ggplot(data, aes(x = long, y = lat, color = whale_identifiers)) +
  geom_point(alpha = 0.6) +
  labs(title = "Map of Whale Sightings", x = "Longitude", y = "Latitude", color = "Whale Identifiers") +
  theme_minimal() +
  theme(legend.position = "right")

```

## timeline of sightings

```{r}

# convert sightDate to Date format (if it wasn't done earlier)
#timeline_data$sightDate <- as.Date(timeline_data$sightDate, format = "%m/%d/%y")

ggplot(timeline_data, aes(x = sightDate, y = whale_identifiers)) +
  geom_point(aes(color = whale_identifiers), alpha = 0.6) +
  scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
  labs(title = "Timeline of Whale Sightings", x = "Date", y = "Whale Identifiers", color = "Whale Identifiers") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```

## movement patterns

```{r}

# Sort by identifiers and date
timeline_data <- timeline_data[order(timeline_data$whale_identifiers, timeline_data$sightDate), ]

ggplot(timeline_data, aes(x = long, y = lat, group = whale_identifiers, color = whale_identifiers)) +
  geom_path(alpha = 0.6) +
  geom_point(alpha = 0.6) +
  labs(title = "Movement Patterns of Identifiable Whales", x = "Longitude", y = "Latitude", color = "Whale Identifiers") +
  theme_minimal() +
  theme(legend.position = "right")

```
